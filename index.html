<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å•†å“æ¸…å•ç®¡ç†ç³»ç»Ÿ</title>
    <meta name="description" content="åœ¨çº¿å•†å“æ¸…å•ç®¡ç†ï¼Œæ”¯æŒä»·æ ¼ä¿®æ”¹ã€å›¾ç‰‡ä¸Šä¼ å’Œå•†å“å¢åˆ ">
    <meta name="keywords" content="å•†å“ç®¡ç†,æ¸…å•ç³»ç»Ÿ,åº“å­˜ç®¡ç†,åœ¨çº¿å·¥å…·">
    <meta name="author" content="Product Inventory System">
    
    <!-- PWA æ”¯æŒ -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#3b82f6">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ›’</text></svg>">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Microsoft YaHei', sans-serif;
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 0;
            touch-action: manipulation;
        }
        
        .container {
            width: 100%;
            min-height: 100vh;
            background: white;
        }
        
        header {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            padding: 20px 15px;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            font-size: 1.4rem;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .subtitle {
            opacity: 0.9;
            font-size: 0.85rem;
        }
        
        .controls {
            padding: 15px;
            background: #f8fafc;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
            position: sticky;
            top: 95px;
            z-index: 90;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .btn {
            padding: 12px 16px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.9rem;
            min-height: 44px;
            min-width: 44px;
        }
        
        .btn-primary {
            background: #3b82f6;
            color: white;
            flex: 1;
        }
        
        .btn-primary:active {
            background: #2563eb;
            transform: scale(0.98);
        }
        
        .btn-success {
            background: #10b981;
            color: white;
        }
        
        .btn-success:active {
            background: #059669;
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
        }
        
        .btn-danger:active {
            background: #dc2626;
        }
        
        .btn-secondary {
            background: #6b7280;
            color: white;
        }
        
        .btn-secondary:active {
            background: #4b5563;
        }
        
        .btn-warning {
            background: #f59e0b;
            color: white;
        }
        
        .btn-warning:active {
            background: #d97706;
        }
        
        .btn-purple {
            background: #8b5cf6;
            color: white;
        }
        
        .btn-purple:active {
            background: #7c3aed;
        }
        
        input, select, textarea {
            padding: 12px 15px;
            border: 1px solid #d1d5db;
            border-radius: 10px;
            font-size: 1rem;
            transition: border 0.3s;
            font-family: inherit;
            width: 100%;
            -webkit-appearance: none;
            appearance: none;
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        /* ç§»åŠ¨ç«¯ä¼˜åŒ–ï¼šæœç´¢æ¡† */
        .search-container {
            flex: 1;
            min-width: 100%;
            order: 3;
            margin-top: 10px;
        }
        
        .main-content {
            display: flex;
            flex-direction: column;
            min-height: calc(100vh - 200px);
        }
        
        /* ç§»åŠ¨ç«¯ï¼šé»˜è®¤æ˜¾ç¤ºåˆ—è¡¨ï¼Œç‚¹å‡»åæ˜¾ç¤ºè¯¦æƒ… */
        .mobile-view {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .product-list-container {
            flex: 1;
            overflow-y: auto;
            display: block;
        }
        
        .product-detail-container {
            flex: 1;
            overflow-y: auto;
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            z-index: 1000;
            padding-bottom: 80px;
        }
        
        .show-detail .product-list-container {
            display: none;
        }
        
        .show-detail .product-detail-container {
            display: block;
        }
        
        /* å•†å“åˆ—è¡¨é¡¹ç§»åŠ¨ç«¯ä¼˜åŒ– */
        .product-list {
            padding: 10px;
        }
        
        .product-list-item {
            padding: 15px;
            border-bottom: 1px solid #f3f4f6;
            cursor: pointer;
            transition: all 0.2s ease;
            background: white;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            touch-action: manipulation;
        }
        
        .product-list-item:active {
            background: #f8fafc;
            transform: scale(0.98);
        }
        
        .product-list-item.active {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
        }
        
        .product-list-name {
            font-weight: 600;
            margin-bottom: 5px;
            color: #1f2937;
            font-size: 1rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .product-list-price {
            color: #059669;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        /* å•†å“è¯¦æƒ…ç§»åŠ¨ç«¯ä¼˜åŒ– */
        .product-detail {
            padding: 20px 15px;
            overflow-y: auto;
            height: 100%;
            -webkit-overflow-scrolling: touch;
        }
        
        .product-detail-header {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            width: 100%;
        }
        
        .product-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #1f2937;
            flex: 1;
            margin-right: 10px;
        }
        
        .product-price-display {
            font-size: 1.5rem;
            color: #059669;
            font-weight: 700;
            white-space: nowrap;
        }
        
        .product-price-display .unit {
            font-size: 0.9rem;
            color: #6b7280;
            margin-left: 5px;
        }
        
        .product-image-container {
            width: 100%;
            height: 200px;
            background: #f3f4f6;
            border-radius: 12px;
            margin-bottom: 20px;
            overflow: hidden;
            position: relative;
        }
        
        .product-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            padding: 10px;
        }
        
        .image-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #9ca3af;
            text-align: center;
            padding: 20px;
        }
        
        .upload-btn-large {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(255,255,255,0.95);
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            border: 1px solid #d1d5db;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.85rem;
            min-height: 36px;
        }
        
        .product-info {
            margin-bottom: 20px;
        }
        
        .section-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: #374151;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .info-item {
            padding: 12px;
            background: #f9fafb;
            border-radius: 8px;
        }
        
        .info-label {
            font-size: 0.8rem;
            color: #6b7280;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .info-value {
            font-size: 1rem;
            color: #1f2937;
            font-weight: 500;
            word-break: break-word;
        }
        
        .editable-value {
            width: 100%;
            padding: 10px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            background: white;
            font-size: 1rem;
            color: #1f2937;
        }
        
        .description-container {
            margin-top: 15px;
        }
        
        .description-text {
            padding: 15px;
            background: #f9fafb;
            border-radius: 8px;
            min-height: 100px;
            line-height: 1.6;
            font-size: 0.95rem;
        }
        
        .description-textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            resize: vertical;
            font-size: 0.95rem;
            line-height: 1.6;
        }
        
        /* ç§»åŠ¨ç«¯åº•éƒ¨æ“ä½œæ  */
        .mobile-actions {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            padding: 15px;
            display: flex;
            gap: 10px;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 100;
        }
        
        .mobile-actions .btn {
            flex: 1;
            min-height: 50px;
            font-size: 1rem;
        }
        
        .detail-actions {
            display: none; /* åœ¨ç§»åŠ¨ç«¯éšè—åŸæ¥çš„æ“ä½œæŒ‰é’® */
        }
        
        /* è¿”å›æŒ‰é’® */
        .back-button {
            position: absolute;
            top: 20px;
            left: 15px;
            background: rgba(255,255,255,0.9);
            border: none;
            border-radius: 50%;
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 101;
            font-size: 1.2rem;
            color: #333;
        }
        
        .edit-mode-banner {
            background: #fffbeb;
            color: #92400e;
            padding: 12px 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border: 1px solid #fde68a;
            font-size: 0.9rem;
        }
        
        .stats {
            padding: 12px 15px;
            background: #f0f9ff;
            border-top: 1px solid #e0f2fe;
            display: flex;
            justify-content: space-between;
            color: #0369a1;
            font-weight: 500;
            font-size: 0.9rem;
            position: sticky;
            bottom: 0;
            z-index: 90;
        }
        
        /* æˆåŠŸæç¤º */
        .success-banner {
            background: #d1fae5;
            color: #065f46;
            padding: 12px 15px;
            border-radius: 10px;
            margin: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #a7f3d0;
            font-size: 0.9rem;
            display: none;
        }
        
        /* æ¨¡æ€æ¡†ç§»åŠ¨ç«¯ä¼˜åŒ– */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            -webkit-overflow-scrolling: touch;
        }
        
        .modal-content {
            background: white;
            padding: 25px;
            border-radius: 15px;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            margin-bottom: 20px;
        }
        
        .modal-header h3 {
            font-size: 1.3rem;
            color: #1f2937;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #4b5563;
            font-size: 0.95rem;
        }
        
        /* ä»·æ ¼è¾“å…¥æ¡†ç§»åŠ¨ç«¯ä¼˜åŒ– */
        .price-input {
            width: 100%;
            padding: 12px 15px;
            font-size: 1.1rem;
            font-weight: 600;
            color: #059669;
        }
        
        /* å“åº”å¼è°ƒæ•´ */
        @media (min-width: 768px) {
            body {
                padding: 20px;
            }
            
            .container {
                max-width: 1400px;
                margin: 0 auto;
                border-radius: 12px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.08);
                overflow: hidden;
                min-height: 90vh;
            }
            
            .controls {
                position: static;
                padding: 20px;
            }
            
            .search-container {
                min-width: auto;
                order: 0;
                margin-top: 0;
                flex: 0 0 300px;
            }
            
            .main-content {
                flex-direction: row;
                height: auto;
            }
            
            .mobile-view {
                flex-direction: row;
                height: auto;
            }
            
            .product-list-container {
                flex: 0 0 350px;
                display: block !important;
                position: static;
                height: auto;
                max-height: 600px;
            }
            
            .product-detail-container {
                flex: 1;
                display: block !important;
                position: static;
                height: auto;
                padding-bottom: 0;
            }
            
            .product-detail {
                padding: 30px;
            }
            
            .mobile-actions {
                display: none;
            }
            
            .detail-actions {
                display: flex;
                gap: 10px;
                margin-top: 30px;
                padding-top: 20px;
                border-top: 1px solid #e5e7eb;
            }
            
            .back-button {
                display: none;
            }
            
            .product-image-container {
                height: 300px;
            }
            
            .info-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 15px;
            }
            
            header {
                padding: 30px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .success-banner {
                margin: 20px;
            }
        }
        
        /* é˜²æ­¢IOSè¾“å…¥æ¡†æ”¾å¤§ */
        @media screen and (max-width: 768px) {
            input, select, textarea {
                font-size: 16px;
            }
        }
        
        /* ä¸Šä¸‹æ–‡èœå• */
        .context-menu {
            position: fixed;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            z-index: 1000;
            min-width: 150px;
            display: none;
        }
        
        .context-menu-item {
            padding: 15px 20px;
            border-bottom: 1px solid #f3f4f6;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
        }
        
        .context-menu-item:active {
            background: #f3f4f6;
        }
        
        .context-menu-item:last-child {
            border-bottom: none;
        }
        
        /* ç©ºçŠ¶æ€æç¤º */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6b7280;
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }
        
        /* åŠ¨ç”» */
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ›’ å•†å“æ¸…å•ç®¡ç†ç³»ç»Ÿ</h1>
            <p class="subtitle">å·²å¯¼å…¥34ä¸ªå•†å“ï¼Œç‚¹å‡»å•†å“æŸ¥çœ‹è¯¦æƒ…ï¼Œæ”¯æŒä¿®æ”¹å•†å“ä¿¡æ¯å’Œå›¾ç‰‡ç®¡ç†</p>
        </header>
        
        <div class="success-banner" id="successBanner">
            <i class="fas fa-check-circle"></i>
            <span style="margin-left: 10px;">å·²æˆåŠŸå¯¼å…¥34ä¸ªå•†å“ï¼</span>
        </div>
        
        <div class="controls">
            <button class="btn btn-primary" onclick="addNewProduct()">
                <i class="fas fa-plus"></i> æ·»åŠ å•†å“
            </button>
            <button class="btn btn-purple" onclick="showImportModal()">
                <i class="fas fa-file-import"></i> å¯¼å…¥
            </button>
            <button class="btn btn-success" onclick="showExportModal()">
                <i class="fas fa-file-export"></i> å¯¼å‡º
            </button>
            <div class="search-container">
                <input type="text" id="searchInput" placeholder="æœç´¢å•†å“åç§°..." 
                       onkeyup="searchProducts()">
            </div>
        </div>
        
        <div class="main-content mobile-view" id="mobileView">
            <!-- å•†å“åˆ—è¡¨ -->
            <div class="product-list-container">
                <div class="product-list" id="productList">
                    <!-- å•†å“åˆ—è¡¨é¡¹ä¼šåŠ¨æ€ç”Ÿæˆåœ¨è¿™é‡Œ -->
                </div>
            </div>
            
            <!-- å•†å“è¯¦æƒ… -->
            <div class="product-detail-container">
                <button class="back-button" onclick="goBackToList()">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <div class="product-detail" id="productDetail">
                    <div class="product-image-container">
                        <div class="image-placeholder" id="detailImagePlaceholder">
                            <i class="fas fa-image fa-5x"></i>
                            <p style="margin-top: 10px;">æš‚æ— å•†å“å›¾ç‰‡</p>
                        </div>
                        <img id="detailProductImage" class="product-image" style="display: none;">
                        <div class="upload-btn-large" onclick="uploadCurrentProductImage()">
                            <i class="fas fa-camera"></i> ä¸Šä¼ å›¾ç‰‡
                        </div>
                    </div>
                    
                    <div class="product-detail-header">
                        <div class="header-top">
                            <h1 class="product-title" id="detailProductName">è¯·é€‰æ‹©å•†å“</h1>
                            <div class="product-price-display" id="detailProductPrice">
                                0 <span class="unit">ç§¯åˆ†</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ç¼–è¾‘æ¨¡å¼æç¤º -->
                    <div class="edit-mode-banner" id="editModeBanner" style="display: none;">
                        <span><i class="fas fa-edit"></i> ç¼–è¾‘æ¨¡å¼å·²å¯ç”¨</span>
                    </div>
                    
                    <!-- å•†å“ä¿¡æ¯ -->
                    <div class="product-info">
                        <div class="section-title">
                            <i class="fas fa-info-circle"></i> å•†å“ä¿¡æ¯
                        </div>
                        
                        <div class="info-grid">
                            <div class="info-item">
                                <div class="info-label">å•†å“ç¼–å·</div>
                                <div class="info-value" id="detailProductId">-</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">å•†å“åˆ†ç±»</div>
                                <div id="categoryDisplay">
                                    <span class="info-value" id="detailProductCategory">æœªåˆ†ç±»</span>
                                    <select class="editable-value" id="categorySelect" style="display: none;">
                                        <option value="é£Ÿå“">é£Ÿå“</option>
                                        <option value="é¥®æ–™">é¥®æ–™</option>
                                        <option value="ç²®æ²¹">ç²®æ²¹</option>
                                        <option value="å®¶ç”µ">å®¶ç”µ</option>
                                        <option value="æ—¥ç”¨å“">æ—¥ç”¨å“</option>
                                        <option value="å¨å…·">å¨å…·</option>
                                        <option value="å…¶ä»–">å…¶ä»–</option>
                                    </select>
                                </div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">åº“å­˜æ•°é‡</div>
                                <div id="stockDisplay">
                                    <span class="info-value" id="detailProductStock">0</span>
                                    <input type="number" class="editable-value" id="stockInput" min="0" style="display: none;">
                                </div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">ä¸Šæ¶æ—¶é—´</div>
                                <div id="dateDisplay">
                                    <span class="info-value" id="detailProductDate">-</span>
                                    <input type="date" class="editable-value" id="dateInput" style="display: none;">
                                </div>
                            </div>
                        </div>
                        
                        <div class="section-title" style="margin-top: 20px;">
                            <i class="fas fa-file-alt"></i> å•†å“æè¿°
                        </div>
                        
                        <div class="description-container">
                            <div class="description-text" id="detailProductDescription">
                                æš‚æ— å•†å“æè¿°
                            </div>
                            <textarea class="description-textarea" id="descriptionTextarea" 
                                      placeholder="è¯·è¾“å…¥å•†å“æè¿°..." style="display: none;"></textarea>
                        </div>
                    </div>
                    
                    <!-- æ¡Œé¢ç«¯æ“ä½œæŒ‰é’® -->
                    <div class="detail-actions">
                        <button class="btn btn-danger" onclick="deleteCurrentProduct()">
                            <i class="fas fa-trash"></i> åˆ é™¤å•†å“
                        </button>
                        <button class="btn btn-secondary" onclick="enableEditMode()" id="editButton">
                            <i class="fas fa-edit"></i> ç¼–è¾‘
                        </button>
                        <button class="btn" onclick="updatePricePrompt()" style="flex: 1;">
                            <i class="fas fa-money-bill-wave"></i> ä¿®æ”¹ä»·æ ¼
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- ç§»åŠ¨ç«¯åº•éƒ¨æ“ä½œæ  -->
            <div class="mobile-actions">
                <button class="btn btn-danger" onclick="deleteCurrentProduct()">
                    <i class="fas fa-trash"></i> åˆ é™¤
                </button>
                <button class="btn btn-secondary" onclick="enableEditMode()" id="mobileEditButton">
                    <i class="fas fa-edit"></i> ç¼–è¾‘
                </button>
                <button class="btn" onclick="updatePricePrompt()">
                    <i class="fas fa-money-bill-wave"></i> ä»·æ ¼
                </button>
            </div>
        </div>
        
        <div class="stats">
            <span>æ€»å•†å“æ•°: <span id="totalProducts">34</span></span>
            <span>æ€»ä»·å€¼: <span id="totalValue">349,625</span> ç§¯åˆ†</span>
        </div>
    </div>
    
    <!-- æ·»åŠ å•†å“å¼¹çª— -->
    <div class="modal" id="addProductModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>æ·»åŠ æ–°å•†å“</h3>
            </div>
            <form id="addProductForm">
                <div class="form-group">
                    <label for="productName">å•†å“åç§°</label>
                    <input type="text" id="productName" required 
                           placeholder="è¯·è¾“å…¥å•†å“åç§°">
                </div>
                <div class="form-group">
                    <label for="productPrice">ä»·æ ¼ï¼ˆç§¯åˆ†ï¼‰</label>
                    <input type="number" id="productPrice" required 
                           placeholder="è¯·è¾“å…¥ä»·æ ¼" min="0" step="1">
                </div>
                <div class="form-group">
                    <label for="newProductCategory">å•†å“åˆ†ç±»</label>
                    <select id="newProductCategory" class="editable-value">
                        <option value="é£Ÿå“">é£Ÿå“</option>
                        <option value="é¥®æ–™">é¥®æ–™</option>
                        <option value="ç²®æ²¹">ç²®æ²¹</option>
                        <option value="å®¶ç”µ">å®¶ç”µ</option>
                        <option value="æ—¥ç”¨å“">æ—¥ç”¨å“</option>
                        <option value="å¨å…·">å¨å…·</option>
                        <option value="å…¶ä»–">å…¶ä»–</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="productStock">åº“å­˜æ•°é‡</label>
                    <input type="number" id="productStock" required 
                           placeholder="è¯·è¾“å…¥åº“å­˜æ•°é‡" min="0" value="0">
                </div>
                <div class="form-group">
                    <label for="productImage">å•†å“å›¾ç‰‡</label>
                    <input type="file" id="productImage" 
                           accept="image/*" style="width: 100%; padding: 8px;">
                </div>
                <div style="display: flex; gap: 10px; margin-top: 30px;">
                    <button type="submit" class="btn btn-success" style="flex: 1;">
                        æ·»åŠ å•†å“
                    </button>
                    <button type="button" class="btn" onclick="closeModal()" 
                            style="flex: 1; background: #f3f4f6;">
                        å–æ¶ˆ
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- å¯¼å…¥Excelæ•°æ®å¼¹çª— -->
    <div class="modal" id="importModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>å¯¼å…¥Excelæ•°æ®</h3>
            </div>
            <div style="margin-bottom: 20px;">
                <p>ç²˜è´´Excelæ•°æ®ï¼ˆä¸¤åˆ—ï¼šå•†å“åç§°å’Œä»·æ ¼ï¼‰:</p>
                <textarea id="excelData" style="width:100%; height:200px; font-family: monospace; padding:10px;" 
                          placeholder="ç±³ä¹‹è‰¯éè½¬åŸºå› å¤§ç±³(2.5KG) 1000&#10;å¿«é¹¿éè½¬åŸºå› å¤§ç±³ï¼ˆ2.5KGï¼‰ 1000&#10;èŠ±å›­æ–°ç–†ç‰›å¥¶ 2000"></textarea>
                <div style="font-size: 12px; color: #666; margin-top: 5px;">
                    æ”¯æŒæ ¼å¼ï¼šå•†å“åç§° ä»·æ ¼ï¼ˆç”¨ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦æˆ–é€—å·åˆ†éš”ï¼‰
                </div>
            </div>
            <div style="display: flex; gap: 10px;">
                <button class="btn btn-success" onclick="importExcelData()" style="flex: 1;">
                    <i class="fas fa-file-import"></i> å¯¼å…¥æ•°æ®
                </button>
                <button class="btn" onclick="closeImportModal()" style="flex: 1; background: #f3f4f6;">
                    å–æ¶ˆ
                </button>
            </div>
        </div>
    </div>

    <!-- å¯¼å‡ºæ•°æ®å¼¹çª— -->
    <div class="modal" id="exportModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>å¯¼å‡ºæ•°æ®</h3>
            </div>
            <div style="margin-bottom: 20px;">
                <p>é€‰æ‹©å¯¼å‡ºæ ¼å¼:</p>
                <div style="display:flex; gap:10px; margin-bottom:20px; flex-wrap: wrap;">
                    <button class="btn" onclick="exportToExcel()" style="flex: 1; min-width: 120px;">
                        <i class="fas fa-file-excel"></i> Excel
                    </button>
                    <button class="btn" onclick="exportToJSON()" style="flex: 1; min-width: 120px;">
                        <i class="fas fa-file-code"></i> JSON
                    </button>
                    <button class="btn" onclick="exportToCSV()" style="flex: 1; min-width: 120px;">
                        <i class="fas fa-file-csv"></i> CSV
                    </button>
                </div>
                <div>
                    <button class="btn" onclick="copyToClipboard()" style="width:100%;">
                        <i class="fas fa-copy"></i> å¤åˆ¶åˆ°å‰ªè´´æ¿
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ç¼–è¾‘ä¿å­˜å¼¹çª— -->
    <div class="modal" id="editActionsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ä¿å­˜ä¿®æ”¹</h3>
            </div>
            <div style="text-align: center; padding: 30px 0;">
                <p>æ˜¯å¦ä¿å­˜å¯¹å•†å“çš„ä¿®æ”¹ï¼Ÿ</p>
            </div>
            <div style="display: flex; gap: 10px;">
                <button class="btn btn-success" style="flex: 1;" onclick="saveProductChanges()">
                    ä¿å­˜
                </button>
                <button class="btn" style="flex: 1; background: #f3f4f6;" onclick="cancelEditMode()">
                    å–æ¶ˆ
                </button>
                <button class="btn" style="flex: 1; background: #f3f4f6;" onclick="discardChanges()">
                    ä¸ä¿å­˜
                </button>
            </div>
        </div>
    </div>

    <!-- ä¸Šä¸‹æ–‡èœå•ï¼ˆé•¿æŒ‰æ“ä½œï¼‰ -->
    <div class="context-menu" id="contextMenu">
        <div class="context-menu-item" onclick="quickEditPrice()">
            <i class="fas fa-money-bill-wave"></i> ä¿®æ”¹ä»·æ ¼
        </div>
        <div class="context-menu-item" onclick="quickDelete()">
            <i class="fas fa-trash"></i> åˆ é™¤å•†å“
        </div>
        <div class="context-menu-item" onclick="uploadImageFromContext()">
            <i class="fas fa-camera"></i> ä¸Šä¼ å›¾ç‰‡
        </div>
    </div>

    <script>
        // ç›´æ¥ä»æ‚¨çš„Excelæ•°æ®åˆå§‹åŒ–å•†å“åˆ—è¡¨
        let products = [
            { id: 1, name: "ç±³ä¹‹è‰¯éè½¬åŸºå› å¤§ç±³(2.5KG)", price: 1000, image: null, category: "ç²®æ²¹", stock: 50, description: "ä¼˜è´¨éè½¬åŸºå› å¤§ç±³ï¼Œå£æ„Ÿé¦™ç³¯", date: "2024-01-15" },
            { id: 2, name: "å¿«é¹¿éè½¬åŸºå› å¤§ç±³ï¼ˆ2.5KGï¼‰", price: 1000, image: null, category: "ç²®æ²¹", stock: 45, description: "ä¼˜è´¨å¤§ç±³ï¼Œé¢—ç²’é¥±æ»¡", date: "2024-01-16" },
            { id: 3, name: "èŠ±å›­æ–°ç–†ç‰›å¥¶", price: 2000, image: null, category: "é£Ÿå“", stock: 100, description: "æºè‡ªæ–°ç–†çš„ä¼˜è´¨å¥¶æºï¼Œè¥å…»ä¸°å¯Œ", date: "2024-01-10" },
            { id: 4, name: "å¤è¶Šé¾™å±±ç»å…´é»„é…’åŠç”œå‹æ¸…é†‡ä¸‰å¹´500ml*6", price: 6000, image: null, category: "é¥®æ–™", stock: 30, description: "ä¸‰å¹´é™ˆé…¿ç»å…´é»„é…’ï¼Œé†‡é¦™å¯å£", date: "2024-01-05" },
            { id: 5, name: "é‡‘é¾™é±¼ç‰ç±³æ²¹(5L)", price: 6000, image: null, category: "ç²®æ²¹", stock: 40, description: "ä¸€çº§ç‰ç±³æ²¹ï¼Œå¥åº·çƒ¹é¥ªé€‰æ‹©", date: "2024-01-12" },
            { id: 6, name: "è¿ˆå¡ç½—é«˜å‹é”…4.2L", price: 20000, image: null, category: "å¨å…·", stock: 20, description: "æ™ºèƒ½é«˜å‹é”…ï¼Œ4.2å‡å¤§å®¹é‡", date: "2024-01-18" },
            { id: 7, name: "ä¼ åŒ–æ´—è¡£çš‚", price: 250, image: null, category: "æ—¥ç”¨å“", stock: 200, description: "é«˜æ•ˆå»æ¸ï¼Œä¿æŠ¤è¡£ç‰©", date: "2024-01-20" },
            { id: 8, name: "å¥¥å…‹æ–¯ç”µè’¸é”…AUX-DZG08-1809", price: 20000, image: null, category: "å®¶ç”µ", stock: 15, description: "å¤šåŠŸèƒ½ç”µè’¸é”…ï¼Œæ™ºèƒ½é¢„çº¦", date: "2024-01-08" },
            { id: 9, name: "è£äº‹è¾¾å¤šåŠŸèƒ½å…»ç”Ÿå£¶", price: 10000, image: null, category: "å®¶ç”µ", stock: 25, description: "å¤šåŠŸèƒ½å…»ç”Ÿå£¶ï¼Œç…®èŒ¶ç‚–æ±¤", date: "2024-01-14" },
            { id: 10, name: "æµ¦æ±Ÿç¦ä¸´é—¨ç‰ç±³æ²¹(1.8L)", price: 2000, image: null, category: "ç²®æ²¹", stock: 60, description: "å°åŒ…è£…ç‰ç±³æ²¹ï¼Œé€‚åˆå°å®¶åº­", date: "2024-01-19" },
            { id: 11, name: "æµ¦æ±Ÿç«‹è€Œç¾ç”µçƒ­æ°´å£¶", price: 10000, image: null, category: "å®¶ç”µ", stock: 35, description: "å¿«é€Ÿæ²¸è…¾ï¼Œå®‰å…¨è‡ªåŠ¨æ–­ç”µ", date: "2024-01-22" },
            { id: 12, name: "æµ¦æ±Ÿè‹æ³Šå°”ç©ºæ°”ç‚¸é”…", price: 30000, image: null, category: "å®¶ç”µ", stock: 18, description: "æ— æ²¹å¥åº·çƒ¹é¥ªï¼Œæ™ºèƒ½è§¦æ§", date: "2024-01-25" },
            { id: 13, name: "çˆ±ä»•è¾¾ç‚’é”…", price: 8000, image: null, category: "å¨å…·", stock: 30, description: "ä¸ç²˜ç‚’é”…ï¼Œå¯¼çƒ­å‡åŒ€", date: "2024-01-28" },
            { id: 14, name: "ç”œæ¡”", price: 4000, image: null, category: "é£Ÿå“", stock: 150, description: "æ–°é²œç”œæ¡”ï¼Œæœè‚‰é¥±æ»¡", date: "2024-01-30" },
            { id: 15, name: "æµ¦æ±ŸåŒæŸšæ±", price: 12000, image: null, category: "é¥®æ–™", stock: 45, description: "æŸšå­é£å‘³é¥®æ–™ï¼Œæ¸…çˆ½è§£æ¸´", date: "2024-02-01" },
            { id: 16, name: "æµ¦æ±Ÿå¸¸å±±èƒ¡æŸš5æ–¤", price: 4000, image: null, category: "é£Ÿå“", stock: 80, description: "å¸¸å±±ç‰¹äº§èƒ¡æŸšï¼Œé…¸ç”œå¯å£", date: "2024-02-02" },
            { id: 17, name: "æµ¦æ±Ÿå¿—é«˜é™¤è¨ä»ª", price: 14000, image: null, category: "å®¶ç”µ", stock: 22, description: "é«˜æ•ˆé™¤è¨ï¼Œç´«å¤–çº¿æ€èŒ", date: "2024-02-03" },
            { id: 18, name: "æµ¦æ±Ÿè£äº‹è¾¾ç”µç…é”…", price: 15000, image: null, category: "å¨å…·", stock: 28, description: "å¤šåŠŸèƒ½ç”µç…é”…ï¼Œä¸ç²˜æ¶‚å±‚", date: "2024-02-04" },
            { id: 19, name: "è´­ç‰©è½¦", price: 10000, image: null, category: "å…¶ä»–", stock: 10, description: "ä¾¿æºè´­ç‰©è½¦ï¼Œæ‰¿é‡èƒ½åŠ›å¼º", date: "2024-02-05" },
            { id: 20, name: "æµ¦æ±Ÿå†·é…¸çµç‰™è†90g", price: 250, image: null, category: "æ—¥ç”¨å“", stock: 120, description: "æŠ—æ•æ„Ÿç‰™è†ï¼Œä¿æŠ¤ç‰™é½¿", date: "2024-02-06" },
            { id: 21, name: "æµ¦æ±Ÿè¿ˆå¡ç½—è±†æµ†æœºMC-PB085", price: 15000, image: null, category: "å®¶ç”µ", stock: 15, description: "å…¨è‡ªåŠ¨è±†æµ†æœºï¼Œå…è¿‡æ»¤", date: "2024-02-07" },
            { id: 22, name: "èƒ–å­å±±æ ¸æ¡ƒ500G(æµ¦æ±Ÿï¼‰", price: 8000, image: null, category: "é£Ÿå“", stock: 65, description: "æµ¦æ±Ÿå±±æ ¸æ¡ƒï¼Œé¦™è„†å¯å£", date: "2024-02-08" },
            { id: 23, name: "æµ¦æ±Ÿåº·å¤«ç”µå¹é£", price: 5000, image: null, category: "å®¶ç”µ", stock: 40, description: "è´Ÿç¦»å­ç”µå¹é£ï¼Œå¿«é€Ÿå¹²å‘", date: "2024-02-09" },
            { id: 24, name: "æµ¦æ±Ÿè¿ˆå¡ç½—ä¾¿æºå¼æœè”¬æ¸…æ´—æœº", price: 15000, image: null, category: "å®¶ç”µ", stock: 25, description: "ä¾¿æºå¼æ¸…æ´—æœºï¼Œå»é™¤å†œæ®‹", date: "2024-02-10" },
            { id: 25, name: "æµ¦æ±Ÿçˆ±ä»•è¾¾å¹³åº•é”…", price: 7500, image: null, category: "å¨å…·", stock: 35, description: "ä¸ç²˜å¹³åº•é”…ï¼Œç…ç‚’çš†å®œ", date: "2024-02-11" },
            { id: 26, name: "æµ¦æ±Ÿç¾çš„å–æš–å™¨NS8-15D", price: 10000, image: null, category: "å®¶ç”µ", stock: 20, description: "æ™ºèƒ½å–æš–å™¨ï¼ŒèŠ‚èƒ½çœç”µ", date: "2024-02-12" },
            { id: 27, name: "æµ¦æ±Ÿæ¸…é£æŠ½çº¸", price: 625, image: null, category: "æ—¥ç”¨å“", stock: 300, description: "æŸ”è½¯æŠ½çº¸ï¼Œå®¶åº­å¿…å¤‡", date: "2024-02-13" },
            { id: 28, name: "æµ¦æ±Ÿå¥¥å…‹æ–¯AUXç”µé£æ‰‡KYT-25", price: 5000, image: null, category: "å®¶ç”µ", stock: 30, description: "å°å¼ç”µé£æ‰‡ï¼Œä¸‰æ¡£é£é€Ÿ", date: "2024-02-14" },
            { id: 29, name: "æµ¦æ±Ÿæ ¼å…°ä»•ç”µçƒ¤ç®±K12", price: 20000, image: null, category: "å®¶ç”µ", stock: 18, description: "å¤šåŠŸèƒ½ç”µçƒ¤ç®±ï¼Œç²¾å‡†æ§æ¸©", date: "2024-02-15" },
            { id: 30, name: "æµ¦æ±Ÿç¾çš„ç”µé¥¼é“›MC-JHN30F", price: 10000, image: null, category: "å¨å…·", stock: 25, description: "åŒé¢åŠ çƒ­ç”µé¥¼é“›ï¼Œè‡ªåŠ¨æ§æ¸©", date: "2024-02-16" },
            { id: 31, name: "æµ¦æ±Ÿç¾çš„ç ´å£æœºMJ-PB12Easy219", price: 30000, image: null, category: "å®¶ç”µ", stock: 12, description: "é«˜é€Ÿç ´å£æœºï¼Œè¥å…»ä¸æµå¤±", date: "2024-02-17" },
            { id: 32, name: "æµ¦æ±Ÿç¾çš„ç”µç£ç‚‰C21-RT2171", price: 15000, image: null, category: "å¨å…·", stock: 28, description: "æ™ºèƒ½ç”µç£ç‚‰ï¼Œå¤šåŠŸèƒ½çƒ¹é¥ª", date: "2024-02-18" },
            { id: 33, name: "æµ¦æ±Ÿç¾çš„æŒ‚çƒ«æœºYG-JA1", price: 20000, image: null, category: "å®¶ç”µ", stock: 16, description: "ä¾¿æºæŒ‚çƒ«æœºï¼Œå¿«é€Ÿé™¤çš±", date: "2024-02-19" },
            { id: 34, name: "æµ¦æ±Ÿé¾™çš„ç»è‚‰æœºLD-KM206", price: 8000, image: null, category: "å¨å…·", stock: 32, description: "å¤šåŠŸèƒ½ç»è‚‰æœºï¼ŒåŠ¨åŠ›å¼ºåŠ²", date: "2024-02-20" }
        ];

        let currentProductId = null;
        let editMode = false;
        let originalProductData = null;
        let contextMenuProductId = null;

        // æ£€æµ‹ç§»åŠ¨è®¾å¤‡
        const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

        // ä»æœ¬åœ°å­˜å‚¨åŠ è½½æ•°æ®
        function loadFromStorage() {
            const saved = localStorage.getItem('productInventory');
            if (saved) {
                try {
                    const parsed = JSON.parse(saved);
                    if (parsed && parsed.length > 0) {
                        products = parsed;
                        console.log(`ä»æœ¬åœ°å­˜å‚¨åŠ è½½äº† ${products.length} ä¸ªå•†å“`);
                    }
                } catch (e) {
                    console.error('æœ¬åœ°å­˜å‚¨æ•°æ®è§£æå¤±è´¥:', e);
                }
            }
        }

        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
        function saveToStorage() {
            localStorage.setItem('productInventory', JSON.stringify(products));
        }

        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats() {
            const totalProducts = products.length;
            const totalValue = products.reduce((sum, product) => sum + (product.price || 0), 0);
            
            document.getElementById('totalProducts').textContent = totalProducts;
            document.getElementById('totalValue').textContent = totalValue.toLocaleString();
        }

        // æ˜¾ç¤ºå¯¼å…¥æˆåŠŸæç¤º
        function showImportSuccess() {
            const banner = document.getElementById('successBanner');
            banner.style.display = 'flex';
            banner.classList.add('fade-in');
            
            setTimeout(() => {
                banner.classList.remove('fade-in');
                setTimeout(() => {
                    banner.style.display = 'none';
                }, 300);
            }, 3000);
        }

        // æ¸²æŸ“å•†å“åˆ—è¡¨
        function renderProductList(productList = products) {
            const productListElement = document.getElementById('productList');
            productListElement.innerHTML = '';
            
            if (productList.length === 0) {
                productListElement.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-box-open"></i>
                        <h3>æš‚æ— å•†å“</h3>
                        <p>ç‚¹å‡»"æ·»åŠ å•†å“"æŒ‰é’®åˆ›å»ºç¬¬ä¸€ä¸ªå•†å“</p>
                    </div>
                `;
                return;
            }
            
            // æŒ‰åˆ†ç±»åˆ†ç»„
            const categorizedProducts = {};
            productList.forEach(product => {
                const category = product.category || 'æœªåˆ†ç±»';
                if (!categorizedProducts[category]) {
                    categorizedProducts[category] = [];
                }
                categorizedProducts[category].push(product);
            });
            
            // æ¸²æŸ“åˆ†ç±»å’Œå•†å“
            Object.keys(categorizedProducts).sort().forEach(category => {
                const categoryProducts = categorizedProducts[category];
                
                // æ·»åŠ åˆ†ç±»æ ‡é¢˜
                const categoryHeader = document.createElement('div');
                categoryHeader.style.cssText = `
                    padding: 10px 15px;
                    background: #f8fafc;
                    margin: 15px 0 10px 0;
                    border-radius: 8px;
                    font-weight: 600;
                    color: #4b5563;
                    font-size: 0.9rem;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                `;
                categoryHeader.innerHTML = `
                    <span><i class="fas fa-tag"></i> ${category}</span>
                    <span style="font-size:0.8rem; color:#9ca3af;">${categoryProducts.length}ä¸ªå•†å“</span>
                `;
                productListElement.appendChild(categoryHeader);
                
                // æ·»åŠ è¯¥åˆ†ç±»çš„å•†å“
                categoryProducts.forEach(product => {
                    const listItem = document.createElement('div');
                    listItem.className = `product-list-item ${currentProductId === product.id ? 'active' : ''}`;
                    listItem.dataset.id = product.id;
                    
                    // æ·»åŠ è§¦æ‘¸äº‹ä»¶
                    if (isMobile) {
                        listItem.ontouchstart = (e) => {
                            e.preventDefault();
                            this.touchStartTime = Date.now();
                            this.longPressTimer = setTimeout(() => {
                                showContextMenu(product.id, e.touches[0].clientX, e.touches[0].clientY);
                            }, 500);
                        };
                        
                        listItem.ontouchend = (e) => {
                            clearTimeout(this.longPressTimer);
                            if (Date.now() - this.touchStartTime < 500) {
                                showProductDetail(product.id);
                            }
                        };
                        
                        listItem.ontouchmove = (e) => {
                            clearTimeout(this.longPressTimer);
                        };
                    } else {
                        listItem.onclick = () => showProductDetail(product.id);
                        listItem.oncontextmenu = (e) => {
                            e.preventDefault();
                            showContextMenu(product.id, e.clientX, e.clientY);
                        };
                    }
                    
                    listItem.innerHTML = `
                        <div class="product-list-name">${product.name}</div>
                        <div class="product-list-price">${product.price.toLocaleString()} ç§¯åˆ†</div>
                        <div style="font-size: 0.8rem; color: #6b7280; margin-top: 5px;">
                            <i class="fas fa-box"></i> åº“å­˜: ${product.stock}
                            ${product.date ? ` | <i class="fas fa-calendar"></i> ${product.date}` : ''}
                        </div>
                    `;
                    productListElement.appendChild(listItem);
                });
            });
            
            updateStats();
        }

        // æ˜¾ç¤ºä¸Šä¸‹æ–‡èœå•ï¼ˆç§»åŠ¨ç«¯é•¿æŒ‰ï¼‰
        function showContextMenu(productId, x, y) {
            contextMenuProductId = productId;
            const contextMenu = document.getElementById('contextMenu');
            contextMenu.style.display = 'block';
            contextMenu.style.left = `${Math.min(x, window.innerWidth - 160)}px`;
            contextMenu.style.top = `${Math.min(y, window.innerHeight - 150)}px`;
        }

        // éšè—ä¸Šä¸‹æ–‡èœå•
        function hideContextMenu() {
            document.getElementById('contextMenu').style.display = 'none';
        }

        // å¿«é€Ÿç¼–è¾‘ä»·æ ¼ï¼ˆä»ä¸Šä¸‹æ–‡èœå•ï¼‰
        function quickEditPrice() {
            const product = products.find(p => p.id === contextMenuProductId);
            if (product) {
                updatePriceForProduct(product.id);
            }
            hideContextMenu();
        }

        // å¿«é€Ÿåˆ é™¤ï¼ˆä»ä¸Šä¸‹æ–‡èœå•ï¼‰
        function quickDelete() {
            const product = products.find(p => p.id === contextMenuProductId);
            if (product) {
                if (confirm(`ç¡®å®šè¦åˆ é™¤"${product.name}"å—ï¼Ÿ`)) {
                    const index = products.findIndex(p => p.id === contextMenuProductId);
                    if (index !== -1) {
                        products.splice(index, 1);
                        saveToStorage();
                        renderProductList();
                        if (currentProductId === contextMenuProductId) {
                            goBackToList();
                        }
                        showMessage('å•†å“åˆ é™¤æˆåŠŸï¼');
                    }
                }
            }
            hideContextMenu();
        }

        // ä»ä¸Šä¸‹æ–‡èœå•ä¸Šä¼ å›¾ç‰‡
        function uploadImageFromContext() {
            const product = products.find(p => p.id === contextMenuProductId);
            if (product) {
                uploadImageForProduct(product.id);
            }
            hideContextMenu();
        }

        // æ˜¾ç¤ºå•†å“è¯¦æƒ…
        function showProductDetail(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            currentProductId = productId;
            
            // åœ¨ç§»åŠ¨ç«¯åˆ‡æ¢åˆ°è¯¦æƒ…è§†å›¾
            if (isMobile && window.innerWidth < 768) {
                document.getElementById('mobileView').classList.add('show-detail');
                document.body.style.overflow = 'hidden';
            }
            
            // æ›´æ–°è¯¦æƒ…é¡µä¿¡æ¯
            updateProductDetailView(product);
            
            // é€€å‡ºç¼–è¾‘æ¨¡å¼
            cancelEditMode();
        }

        // æ›´æ–°å•†å“è¯¦æƒ…è§†å›¾
        function updateProductDetailView(product) {
            document.getElementById('detailProductName').textContent = product.name;
            document.getElementById('detailProductPrice').innerHTML = `
                ${product.price.toLocaleString()} <span class="unit">ç§¯åˆ†</span>
            `;
            document.getElementById('detailProductId').textContent = product.id;
            document.getElementById('detailProductCategory').textContent = product.category;
            document.getElementById('detailProductStock').textContent = product.stock;
            document.getElementById('detailProductDate').textContent = product.date || '-';
            document.getElementById('detailProductDescription').textContent = 
                product.description || 'æš‚æ— å•†å“æè¿°';
            
            // æ›´æ–°å›¾ç‰‡
            const detailImage = document.getElementById('detailProductImage');
            const placeholder = document.getElementById('detailImagePlaceholder');
            
            if (product.image) {
                detailImage.src = product.image;
                detailImage.style.display = 'block';
                placeholder.style.display = 'none';
            } else {
                detailImage.style.display = 'none';
                placeholder.style.display = 'flex';
            }
        }

        // è¿”å›åˆ°åˆ—è¡¨ï¼ˆç§»åŠ¨ç«¯ï¼‰
        function goBackToList() {
            document.getElementById('mobileView').classList.remove('show-detail');
            document.body.style.overflow = 'auto';
            cancelEditMode();
        }

        // å¯ç”¨ç¼–è¾‘æ¨¡å¼
        function enableEditMode() {
            if (!currentProductId) {
                if (isMobile) {
                    alert('è¯·å…ˆé€‰æ‹©å•†å“');
                }
                return;
            }
            
            const product = products.find(p => p.id === currentProductId);
            if (!product) return;
            
            editMode = true;
            originalProductData = { ...product };
            
            // æ˜¾ç¤ºç¼–è¾‘æ¨¡å¼æç¤º
            document.getElementById('editModeBanner').style.display = 'flex';
            
            // åœ¨ç§»åŠ¨ç«¯æ˜¾ç¤ºä¿å­˜æŒ‰é’®
            if (isMobile && window.innerWidth < 768) {
                document.getElementById('mobileEditButton').innerHTML = '<i class="fas fa-save"></i> ä¿å­˜';
                document.getElementById('mobileEditButton').onclick = showSaveConfirmModal;
            }
            
            // å¯ç”¨åˆ†ç±»ç¼–è¾‘
            const categorySelect = document.getElementById('categorySelect');
            categorySelect.value = product.category;
            categorySelect.style.display = 'block';
            document.getElementById('detailProductCategory').style.display = 'none';
            
            // å¯ç”¨åº“å­˜ç¼–è¾‘
            const stockInput = document.getElementById('stockInput');
            stockInput.value = product.stock;
            stockInput.style.display = 'block';
            document.getElementById('detailProductStock').style.display = 'none';
            
            // å¯ç”¨æ—¥æœŸç¼–è¾‘
            const dateInput = document.getElementById('dateInput');
            dateInput.value = product.date || '';
            dateInput.style.display = 'block';
            document.getElementById('detailProductDate').style.display = 'none';
            
            // å¯ç”¨æè¿°ç¼–è¾‘
            const descriptionTextarea = document.getElementById('descriptionTextarea');
            descriptionTextarea.value = product.description || '';
            descriptionTextarea.style.display = 'block';
            document.getElementById('detailProductDescription').style.display = 'none';
        }

        // æ˜¾ç¤ºä¿å­˜ç¡®è®¤å¼¹çª—
        function showSaveConfirmModal() {
            document.getElementById('editActionsModal').style.display = 'flex';
        }

        // ä¿å­˜å•†å“ä¿®æ”¹
        function saveProductChanges() {
            if (!currentProductId || !editMode) return;
            
            const product = products.find(p => p.id === currentProductId);
            if (!product) return;
            
            // è·å–ç¼–è¾‘åçš„å€¼
            const categorySelect = document.getElementById('categorySelect');
            const stockInput = document.getElementById('stockInput');
            const dateInput = document.getElementById('dateInput');
            const descriptionTextarea = document.getElementById('descriptionTextarea');
            
            product.category = categorySelect.value;
            product.stock = parseInt(stockInput.value) || 0;
            product.date = dateInput.value;
            product.description = descriptionTextarea.value;
            
            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            saveToStorage();
            
            // é€€å‡ºç¼–è¾‘æ¨¡å¼å¹¶åˆ·æ–°æ˜¾ç¤º
            cancelEditMode();
            updateProductDetailView(product);
            
            // æ›´æ–°åˆ—è¡¨æ˜¾ç¤º
            const listItem = document.querySelector(`.product-list-item[data-id="${currentProductId}"]`);
            if (listItem) {
                listItem.querySelector('.product-list-name').textContent = product.name;
                const infoDiv = listItem.querySelector('div:nth-child(3)');
                if (infoDiv) {
                    infoDiv.innerHTML = `
                        <i class="fas fa-box"></i> åº“å­˜: ${product.stock}
                        ${product.date ? ` | <i class="fas fa-calendar"></i> ${product.date}` : ''}
                    `;
                }
            }
            
            showMessage('å•†å“ä¿¡æ¯å·²ä¿å­˜ï¼');
            document.getElementById('editActionsModal').style.display = 'none';
        }

        // æ”¾å¼ƒä¿®æ”¹
        function discardChanges() {
            cancelEditMode();
            document.getElementById('editActionsModal').style.display = 'none';
        }

        // å–æ¶ˆç¼–è¾‘æ¨¡å¼
        function cancelEditMode() {
            editMode = false;
            originalProductData = null;
            
            // éšè—ç¼–è¾‘æ¨¡å¼æç¤º
            document.getElementById('editModeBanner').style.display = 'none';
            
            // æ¢å¤ç§»åŠ¨ç«¯ç¼–è¾‘æŒ‰é’®
            if (isMobile && window.innerWidth < 768) {
                document.getElementById('mobileEditButton').innerHTML = '<i class="fas fa-edit"></i> ç¼–è¾‘';
                document.getElementById('mobileEditButton').onclick = enableEditMode;
            }
            
            // æ¢å¤åˆ†ç±»æ˜¾ç¤º
            document.getElementById('categorySelect').style.display = 'none';
            document.getElementById('detailProductCategory').style.display = 'block';
            
            // æ¢å¤åº“å­˜æ˜¾ç¤º
            document.getElementById('stockInput').style.display = 'none';
            document.getElementById('detailProductStock').style.display = 'block';
            
            // æ¢å¤æ—¥æœŸæ˜¾ç¤º
            document.getElementById('dateInput').style.display = 'none';
            document.getElementById('detailProductDate').style.display = 'block';
            
            // æ¢å¤æè¿°æ˜¾ç¤º
            document.getElementById('descriptionTextarea').style.display = 'none';
            document.getElementById('detailProductDescription').style.display = 'block';
        }

        // ä¸ºç‰¹å®šå•†å“ä¸Šä¼ å›¾ç‰‡
        function uploadImageForProduct(productId) {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            
            input.onchange = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        const product = products.find(p => p.id === productId);
                        if (product) {
                            product.image = event.target.result;
                            saveToStorage();
                            
                            // å¦‚æœå½“å‰æ˜¾ç¤ºçš„æ˜¯è¿™ä¸ªå•†å“ï¼Œæ›´æ–°è¯¦æƒ…è§†å›¾
                            if (currentProductId === productId) {
                                updateProductDetailView(product);
                            }
                            
                            showMessage('å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼');
                        }
                    };
                    reader.readAsDataURL(file);
                }
            };
            
            input.click();
        }

        // ä¸Šä¼ å½“å‰å•†å“å›¾ç‰‡
        function uploadCurrentProductImage() {
            if (!currentProductId) {
                alert('è¯·å…ˆé€‰æ‹©å•†å“');
                return;
            }
            uploadImageForProduct(currentProductId);
        }

        // åˆ é™¤å½“å‰å•†å“
        function deleteCurrentProduct() {
            if (!currentProductId) {
                alert('è¯·å…ˆé€‰æ‹©å•†å“');
                return;
            }
            
            const product = products.find(p => p.id === currentProductId);
            if (!product) return;
            
            if (confirm(`ç¡®å®šè¦åˆ é™¤"${product.name}"å—ï¼Ÿ`)) {
                const index = products.findIndex(p => p.id === currentProductId);
                if (index !== -1) {
                    products.splice(index, 1);
                    saveToStorage();
                    
                    // è¿”å›åˆ—è¡¨è§†å›¾
                    goBackToList();
                    
                    // æ˜¾ç¤ºä¸‹ä¸€ä¸ªå•†å“æˆ–æ¸…ç©ºè¯¦æƒ…
                    if (products.length > 0) {
                        setTimeout(() => {
                            const firstProduct = products[0];
                            showProductDetail(firstProduct.id);
                        }, 300);
                    } else {
                        clearProductDetail();
                    }
                    
                    renderProductList();
                    showMessage('å•†å“åˆ é™¤æˆåŠŸï¼');
                }
            }
        }

        // æ¸…ç©ºå•†å“è¯¦æƒ…æ˜¾ç¤º
        function clearProductDetail() {
            currentProductId = null;
            
            document.getElementById('detailProductName').textContent = 'è¯·é€‰æ‹©å•†å“';
            document.getElementById('detailProductPrice').innerHTML = '0 <span class="unit">ç§¯åˆ†</span>';
            document.getElementById('detailProductId').textContent = '-';
            document.getElementById('detailProductCategory').textContent = '-';
            document.getElementById('detailProductStock').textContent = '0';
            document.getElementById('detailProductDate').textContent = '-';
            document.getElementById('detailProductDescription').textContent = 'æš‚æ— å•†å“æè¿°';
            
            const detailImage = document.getElementById('detailProductImage');
            const placeholder = document.getElementById('detailImagePlaceholder');
            detailImage.style.display = 'none';
            placeholder.style.display = 'flex';
            
            cancelEditMode();
        }

        // ä¿®æ”¹ä»·æ ¼æç¤º
        function updatePricePrompt() {
            if (!currentProductId) {
                alert('è¯·å…ˆé€‰æ‹©å•†å“');
                return;
            }
            updatePriceForProduct(currentProductId);
        }

        // ä¸ºç‰¹å®šå•†å“ä¿®æ”¹ä»·æ ¼
        function updatePriceForProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            const newPrice = prompt(`è¯·è¾“å…¥"${product.name}"çš„æ–°ä»·æ ¼ï¼ˆç§¯åˆ†ï¼‰:`, product.price);
            if (newPrice !== null) {
                const price = parseInt(newPrice);
                if (!isNaN(price) && price >= 0) {
                    product.price = price;
                    saveToStorage();
                    
                    // å¦‚æœå½“å‰æ˜¾ç¤ºçš„æ˜¯è¿™ä¸ªå•†å“ï¼Œæ›´æ–°è¯¦æƒ…è§†å›¾
                    if (currentProductId === productId) {
                        updateProductDetailView(product);
                    }
                    
                    // æ›´æ–°åˆ—è¡¨é¡¹ä¸­çš„ä»·æ ¼æ˜¾ç¤º
                    const listItem = document.querySelector(`.product-list-item[data-id="${productId}"]`);
                    if (listItem) {
                        const priceElement = listItem.querySelector('.product-list-price');
                        if (priceElement) {
                            priceElement.textContent = `${price.toLocaleString()} ç§¯åˆ†`;
                        }
                    }
                    
                    updateStats();
                    showMessage('ä»·æ ¼ä¿®æ”¹æˆåŠŸï¼');
                } else {
                    alert('è¯·è¾“å…¥æœ‰æ•ˆçš„ä»·æ ¼æ•°å­—ï¼');
                }
            }
        }

        // æ·»åŠ æ–°å•†å“
        function addNewProduct() {
            document.getElementById('addProductModal').style.display = 'flex';
        }

        // å…³é—­å¼¹çª—
        function closeModal() {
            document.getElementById('addProductModal').style.display = 'none';
            document.getElementById('editActionsModal').style.display = 'none';
            document.getElementById('addProductForm').reset();
        }

        // æ˜¾ç¤ºå¯¼å…¥æ¨¡æ€æ¡†
        function showImportModal() {
            document.getElementById('importModal').style.display = 'flex';
        }

        // å…³é—­å¯¼å…¥æ¨¡æ€æ¡†
        function closeImportModal() {
            document.getElementById('importModal').style.display = 'none';
            document.getElementById('excelData').value = '';
        }

        // æ˜¾ç¤ºå¯¼å‡ºæ¨¡æ€æ¡†
        function showExportModal() {
            document.getElementById('exportModal').style.display = 'flex';
        }

        // å…³é—­å¯¼å‡ºæ¨¡æ€æ¡†
        function closeExportModal() {
            document.getElementById('exportModal').style.display = 'none';
        }

        // å¯¼å…¥Excelæ•°æ®
        function importExcelData() {
            const data = document.getElementById('excelData').value.trim();
            if (!data) {
                alert('è¯·ç²˜è´´æ•°æ®');
                return;
            }
            
            const lines = data.split('\n');
            const newProducts = [];
            let id = products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1;
            let importedCount = 0;
            
            lines.forEach(line => {
                line = line.trim();
                if (line) {
                    // å°è¯•ä¸åŒçš„åˆ†éš”ç¬¦ï¼šç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€é€—å·
                    const parts = line.split(/[\t,]/).map(p => p.trim());
                    if (parts.length >= 2) {
                        const name = parts[0];
                        const price = parseInt(parts[1]) || 0;
                        
                        const newProduct = {
                            id: id++,
                            name: name,
                            price: price,
                            category: "æœªåˆ†ç±»",
                            stock: 0,
                            description: "",
                            date: new Date().toISOString().split('T')[0],
                            image: null
                        };
                        
                        newProducts.push(newProduct);
                        importedCount++;
                    }
                }
            });
            
            if (newProducts.length > 0) {
                if (confirm(`å°†å¯¼å…¥ ${newProducts.length} ä¸ªå•†å“ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ`)) {
                    products = [...products, ...newProducts];
                    saveToStorage();
                    renderProductList();
                    showMessage(`æˆåŠŸå¯¼å…¥ ${newProducts.length} ä¸ªå•†å“ï¼`);
                    closeImportModal();
                }
            } else {
                alert('æ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆçš„æ•°æ®ï¼Œè¯·æ£€æŸ¥æ ¼å¼');
            }
        }

        // å¯¼å‡ºåˆ°Excel
        function exportToExcel() {
            const headers = ['å•†å“åç§°', 'ä»·æ ¼(ç§¯åˆ†)', 'åˆ†ç±»', 'åº“å­˜', 'ä¸Šæ¶æ—¶é—´', 'æè¿°'];
            const data = products.map(p => [
                p.name,
                p.price,
                p.category,
                p.stock,
                p.date,
                p.description || ''
            ]);
            
            let csvContent = headers.join(',') + '\n';
            data.forEach(row => {
                csvContent += row.map(cell => `"${cell}"`).join(',') + '\n';
            });
            
            const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `å•†å“æ¸…å•_${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
            closeExportModal();
        }

        // å¯¼å‡ºåˆ°JSON
        function exportToJSON() {
            const dataStr = JSON.stringify(products, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `å•†å“æ¸…å•_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            closeExportModal();
        }

        // å¯¼å‡ºåˆ°CSV
        function exportToCSV() {
            exportToExcel(); // ä½¿ç”¨ç›¸åŒçš„Excelå¯¼å‡ºé€»è¾‘
        }

        // å¤åˆ¶åˆ°å‰ªè´´æ¿
        function copyToClipboard() {
            const data = products.map(p => `${p.name}\t${p.price}\t${p.category}\t${p.stock}`).join('\n');
            navigator.clipboard.writeText(data).then(() => {
                showMessage('æ•°æ®å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
                closeExportModal();
            }).catch(err => {
                alert('å¤åˆ¶å¤±è´¥: ' + err);
            });
        }

        // æœç´¢å•†å“
        function searchProducts() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            if (!searchTerm) {
                renderProductList();
                return;
            }
            
            const filtered = products.filter(product => 
                product.name.toLowerCase().includes(searchTerm) ||
                product.category.toLowerCase().includes(searchTerm) ||
                (product.description && product.description.toLowerCase().includes(searchTerm))
            );
            renderProductList(filtered);
            
            // å¦‚æœæœç´¢ç»“æœæœ‰å•†å“ä¸”å½“å‰é€‰ä¸­çš„ä¸åœ¨ç»“æœä¸­ï¼Œæ˜¾ç¤ºç¬¬ä¸€ä¸ªç»“æœ
            if (filtered.length > 0 && !filtered.find(p => p.id === currentProductId)) {
                if (isMobile && window.innerWidth < 768) {
                    // ç§»åŠ¨ç«¯ä¿æŒåœ¨åˆ—è¡¨è§†å›¾
                    document.getElementById('mobileView').classList.remove('show-detail');
                }
                currentProductId = filtered[0].id;
                updateProductDetailView(filtered[0]);
            } else if (filtered.length === 0) {
                if (isMobile && window.innerWidth < 768) {
                    goBackToList();
                }
                clearProductDetail();
            }
        }

        // æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
        function showMessage(message) {
            const alert = document.createElement('div');
            alert.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #10b981;
                color: white;
                padding: 12px 24px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 2000;
                animation: slideIn 0.3s ease;
                max-width: 90%;
                word-break: break-word;
            `;
            alert.textContent = message;
            document.body.appendChild(alert);
            
            setTimeout(() => {
                alert.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => document.body.removeChild(alert), 300);
            }, 2000);
        }

        // è¡¨å•æäº¤å¤„ç†
        document.getElementById('addProductForm').onsubmit = function(e) {
            e.preventDefault();
            
            const name = document.getElementById('productName').value.trim();
            const price = parseInt(document.getElementById('productPrice').value) || 0;
            const category = document.getElementById('newProductCategory').value;
            const stock = parseInt(document.getElementById('productStock').value) || 0;
            const imageFile = document.getElementById('productImage').files[0];
            
            if (!name) {
                alert('è¯·è¾“å…¥å•†å“åç§°');
                return;
            }
            
            const newProduct = {
                id: products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1,
                name: name,
                price: price,
                category: category,
                stock: stock,
                description: "",
                date: new Date().toISOString().split('T')[0],
                image: null
            };
            
            const processImage = (imageData) => {
                newProduct.image = imageData;
                products.push(newProduct);
                saveToStorage();
                renderProductList();
                
                if (isMobile && window.innerWidth < 768) {
                    showProductDetail(newProduct.id);
                } else {
                    updateProductDetailView(newProduct);
                }
                
                closeModal();
                showMessage('å•†å“æ·»åŠ æˆåŠŸï¼');
            };
            
            if (imageFile) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    processImage(event.target.result);
                };
                reader.readAsDataURL(imageFile);
            } else {
                processImage(null);
            }
        };

        // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­
        window.onclick = function(event) {
            const modals = ['addProductModal', 'editActionsModal', 'importModal', 'exportModal'];
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (event.target === modal) {
                    if (modalId === 'importModal') closeImportModal();
                    else if (modalId === 'exportModal') closeExportModal();
                    else closeModal();
                }
            });
            
            // ç‚¹å‡»å…¶ä»–åœ°æ–¹éšè—ä¸Šä¸‹æ–‡èœå•
            if (!event.target.closest('.context-menu')) {
                hideContextMenu();
            }
        };

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            // å°è¯•ä»æœ¬åœ°å­˜å‚¨åŠ è½½ï¼Œå¦‚æœå¤±è´¥åˆ™ä½¿ç”¨é»˜è®¤æ•°æ®
            try {
                loadFromStorage();
            } catch (e) {
                console.log('ä½¿ç”¨é»˜è®¤å•†å“æ•°æ®');
            }
            
            renderProductList();
            
            // æ˜¾ç¤ºå¯¼å…¥æˆåŠŸæç¤º
            showImportSuccess();
            
            // åˆå§‹åŒ–æ—¥æœŸè¾“å…¥æ¡†çš„é»˜è®¤å€¼ä¸ºä»Šå¤©
            document.getElementById('dateInput').valueAsDate = new Date();
            
            // åœ¨ç§»åŠ¨ç«¯åˆå§‹åŒ–æ—¶æ˜¾ç¤ºåˆ—è¡¨
            if (isMobile && window.innerWidth < 768) {
                goBackToList();
            } else if (products.length > 0) {
                showProductDetail(products[0].id);
            }
            
            // æ·»åŠ é”®ç›˜å¿«æ·é”®
            document.addEventListener('keydown', function(e) {
                // Ctrl+F èšç„¦æœç´¢æ¡†
                if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
                    e.preventDefault();
                    document.getElementById('searchInput').focus();
                }
                // Ctrl+N æ–°å»ºå•†å“
                if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
                    e.preventDefault();
                    addNewProduct();
                }
                // Esc è¿”å›åˆ—è¡¨æˆ–å…³é—­æ¨¡æ€æ¡†
                if (e.key === 'Escape') {
                    if (isMobile && window.innerWidth < 768 && 
                        document.getElementById('mobileView').classList.contains('show-detail')) {
                        goBackToList();
                    } else if (document.getElementById('addProductModal').style.display === 'flex') {
                        closeModal();
                    } else if (document.getElementById('importModal').style.display === 'flex') {
                        closeImportModal();
                    } else if (document.getElementById('exportModal').style.display === 'flex') {
                        closeExportModal();
                    }
                }
            });
        });

        // ç¡®ä¿åœ¨çª—å£å¤§å°å˜åŒ–æ—¶è°ƒæ•´å¸ƒå±€
        window.addEventListener('resize', function() {
            if (window.innerWidth >= 768) {
                // æ¡Œé¢ç«¯ï¼šç¡®ä¿è¯¦æƒ…è§†å›¾å¯è§
                document.getElementById('mobileView').classList.remove('show-detail');
                document.body.style.overflow = 'auto';
            }
        });

        // æ·»åŠ å·¥å‚è‡ªåŠ¨ä¿å­˜
        setInterval(() => {
            if (products.length > 0) {
                saveToStorage();
            }
        }, 30000); // æ¯30ç§’è‡ªåŠ¨ä¿å­˜ä¸€æ¬¡
    </script>
</body>
</html>